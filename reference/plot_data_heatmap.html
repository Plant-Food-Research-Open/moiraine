<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="For a given set of features, plots their value across the samples as a
heatmap."><title>Plots omics data as heatmap — plot_data_heatmap • moiraine</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plots omics data as heatmap — plot_data_heatmap"><meta property="og:description" content="For a given set of features, plots their value across the samples as a
heatmap."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">moiraine</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://solid-lamp-kq546rq.pages.github.io/">Manual</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/PlantandFoodResearch/moiraine">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plots omics data as heatmap</h1>
      <small class="dont-index">Source: <a href="https://github.com/PlantandFoodResearch/moiraine/blob/HEAD/R/multidataset_plots.R" class="external-link"><code>R/multidataset_plots.R</code></a></small>
      <div class="d-none name"><code>plot_data_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For a given set of features, plots their value across the samples as a
heatmap.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_data_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">mo_data</span>,</span>
<span>  <span class="va">features</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  only_common_samples <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  samples_info <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  features_info <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colours_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  truncate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_title_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  legend_text_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  legend_ncol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>mo_data</dt>
<dd><p>A <a href="https://rdrr.io/pkg/MultiDataSet/man/MultiDataSet-class.html" class="external-link">MultiDataSet::MultiDataSet</a> object.</p></dd>


<dt>features</dt>
<dd><p>Character vector, the ID of features to show in the plot.</p></dd>


<dt>center</dt>
<dd><p>Logical, whether the data should be centered (feature-wise).
Default value is <code>FALSE</code>.</p></dd>


<dt>scale</dt>
<dd><p>Logical, whether the data should be scaled (feature-wise).
Default value is <code>FALSE</code>.</p></dd>


<dt>samples</dt>
<dd><p>Character vector, the ID of samples to include in the plot. If
<code>NULL</code> (default), all samples will be used.</p></dd>


<dt>only_common_samples</dt>
<dd><p>Logical, whether only samples that are present in
all datasets should be plotted. Default value is <code>FALSE</code>.</p></dd>


<dt>samples_info</dt>
<dd><p>Character vector, column names from the samples metadata
tables of the datasets to be represented in the plot as samples annotation.</p></dd>


<dt>features_info</dt>
<dd><p>Named list of character vectors, where each element
corresponds to a dataset, and gives the column names from the features
metadata of the dataset to be represented in the plot as features
annotation. The names of the list must correspond to dataset names in the
<code>mo_data</code> object.</p></dd>


<dt>colours_list</dt>
<dd><p>Named list, where each element gives the colour palette
to use in the samples or features annotation. Names must match values in
<code>samples_info</code> vector and elements of <code>features_info</code> list. For continuous
palettes, must use <code><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">circlize::colorRamp2()</a></code> function (see the
<a href="https://jokergoo.github.io/ComplexHeatmap-reference/book/heatmap-annotations.html#simple-annotation" class="external-link">ComplexHeatmap reference book</a>).</p></dd>


<dt>label_cols</dt>
<dd><p>Character or named list of character, giving for each
dataset the name of the column in the corresponding features metadata to
use as label. If one value, will be used for all datasets. If list, the
names must correspond to the names of the datasets in <code>mo_data</code>. If a
dataset is missing from the list or no value is provided, feature IDs will
be used as labels. Alternatively, use <code>feature_id</code> to get the feature IDs
as labels.</p></dd>


<dt>truncate</dt>
<dd><p>Integer, width to which the labels should be truncated (to
avoid issues with very long labels in plots). If <code>NULL</code> (default value), no
truncation will be performed.</p></dd>


<dt>legend_title_size</dt>
<dd><p>Integer, size in points of legend title.</p></dd>


<dt>legend_text_size</dt>
<dd><p>Integer, size in points of legend elements text.</p></dd>


<dt>legend_ncol</dt>
<dd><p>Integer, number of columns in the legend. Default value is
<code>1</code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to the <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>
function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap-class.html" class="external-link">ComplexHeatmap::Heatmap</a> object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## Selecting at random 3 features from each dataset</span></span></span>
<span class="r-in"><span><span class="va">random_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_features.html">get_features</a></span><span class="op">(</span><span class="va">mo_set</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">map</span><span class="op">(</span><span class="va">sample</span>, size <span class="op">=</span> <span class="fl">3</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_data_heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">mo_set</span>,</span></span>
<span class="r-in"><span>  <span class="va">random_features</span>,</span></span>
<span class="r-in"><span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  show_column_names <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  only_common_samples <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  samples_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"status"</span>, <span class="st">"day_on_feed"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  features_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chromosome"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  colours_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span> <span class="op">=</span> <span class="st">"gold"</span>, <span class="st">"BRD"</span> <span class="op">=</span> <span class="st">"navyblue"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"day_on_feed"</span> <span class="op">=</span> <span class="fu">colorRamp2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">65</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"pink3"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>     <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Olivia Angelin-Bonnet.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

